<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - MedLife Plus</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&family=Roboto+Mono:wght@400;600&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> <style>
        :root {
            --color-in: #198754;      /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
            --color-out: #dc3545;     /* ‡πÅ‡∏î‡∏á‡πÄ‡∏Ç‡πâ‡∏° */
            --color-leave: #6c757d;   /* ‡πÄ‡∏ó‡∏≤‡πÄ‡∏Ç‡πâ‡∏° */
            --color-shift-am: #0d6efd; /* ‡∏ü‡πâ‡∏≤ */
            --color-shift-pm: #fd7e14; /* ‡∏™‡πâ‡∏° */
            --color-shift-night: #6f42c1; /* ‡∏°‡πà‡∏ß‡∏á */
            --bg-body: #f4f6f9;
        }

        body { background-color: var(--bg-body); font-family: 'Sarabun', sans-serif; font-size: 0.95rem; }
        
        /* 2. Table & Accessibility Improvements */
        .table-responsive { max-height: 70vh; overflow-y: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        thead th { position: sticky; top: 0; background-color: #f8f9fa !important; z-index: 10; font-weight: 600; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 0.5px; }
        .table-striped tbody tr:nth-of-type(odd) { background-color: rgba(0,0,0,.02); }
        .table-hover tbody tr:hover { background-color: rgba(0,0,0,.04); transition: 0.2s; }
        
        /* Fixed Width User Column */
        .col-user { width: 260px; min-width: 260px; max-width: 260px; }
        .user-cell { display: flex; align-items: center; gap: 12px; }
        .profile-thumb { width: 45px; height: 45px; border-radius: 50%; object-fit: cover; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .user-info h6 { margin: 0; font-weight: 600; font-size: 0.95rem; }
        .user-info small { color: #6c757d; font-size: 0.8rem; }

        /* Monospace for Numbers/Time */
        .mono-font { font-family: 'Roboto Mono', monospace; font-weight: 500; }

        /* Badges & Dots */
        .status-dot { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 6px; }
        .text-status-in { color: var(--color-in); }
        .bg-status-in { background-color: var(--color-in); }
        .text-status-out { color: var(--color-out); }
        .bg-status-out { background-color: var(--color-out); }
        
        .badge-pill { border-radius: 50px; padding: 0.35em 0.8em; font-weight: 500; }

        /* 3. Navigation & Header */
        .navbar-custom { background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.05); padding: 0.8rem 1rem; }
        .nav-tabs { border-bottom: 2px solid #e9ecef; flex-wrap: nowrap; overflow-x: auto; overflow-y: hidden; }
        .nav-tabs .nav-link { border: none; color: #6c757d; font-weight: 600; padding: 1rem 1.5rem; white-space: nowrap; }
        .nav-tabs .nav-link.active { color: var(--color-shift-am); border-bottom: 3px solid var(--color-shift-am); background: transparent; }
        
        /* Notification Bell */
        .notification-btn { position: relative; font-size: 1.2rem; margin-right: 15px; cursor: pointer; color: #555; }
        .notification-badge { position: absolute; top: -5px; right: -5px; background: var(--color-out); color: white; font-size: 0.7rem; width: 18px; height: 18px; border-radius: 50%; display: flex; justify-content: center; align-items: center; }

        /* 4. Login Professional */
        .login-card { border: none; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); background: white; padding: 2rem; }
        
        /* 5. Mobile Responsive Tweaks */
        @media (max-width: 768px) {
            .hide-mobile { display: none !important; }
            .col-user { width: auto; min-width: auto; }
            .btn-responsive { width: 100%; margin-bottom: 5px; }
            .search-bar-global { width: 100% !important; margin-bottom: 10px; }
        }

        /* 6. Micro-interactions */
        .btn { transition: transform 0.1s; border-radius: 8px; }
        .btn:active { transform: scale(0.98); }
        .card { border: none; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.03); margin-bottom: 20px; transition: transform 0.2s; }
        .card:hover { transform: translateY(-2px); }

        /* Calendar */
        #calendar { background: white; padding: 15px; border-radius: 12px; }
        .fc-event { border-radius: 4px; border: none; padding: 2px 4px; font-size: 0.85rem; }
    </style>
</head>
<body>

    <div id="loginPage" class="d-flex justify-content-center align-items-center" style="height: 100vh; background: #eef2f6;">
        <div class="login-card text-center" style="width: 100%; max-width: 400px;">
            <div class="mb-4">
                <i class="bi bi-hospital-fill text-primary" style="font-size: 3rem;"></i>
                <h3 class="mt-2 fw-bold text-dark">MedLife Plus</h3>
                <p class="text-muted">Admin Portal Login</p>
            </div>
            <div class="form-floating mb-3">
                <input type="email" id="email" class="form-control" placeholder="Email" value="">
                <label for="email">Email Address</label>
            </div>
            <button onclick="sendLoginLink()" id="btnSend" class="btn btn-primary btn-lg w-100 py-3 fw-bold shadow-sm">
                <span id="btnText">‡∏™‡πà‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (Magic Link)</span>
                <span id="btnSpinner" class="spinner-border spinner-border-sm d-none"></span>
            </button>
        </div>
    </div>

    <div id="dashboardPage" class="hidden">
        
        <nav class="navbar navbar-custom sticky-top d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center gap-3">
                <i class="bi bi-hospital-fill text-primary fs-3"></i>
                <h5 class="mb-0 d-none d-md-block fw-bold">MedLife Plus <span class="text-muted fw-normal">| Admin Dashboard</span></h5>
            </div>
            
            <div class="d-flex align-items-center">
                <div class="input-group me-3 d-none d-md-flex" style="width: 250px;">
                    <span class="input-group-text bg-light border-end-0"><i class="bi bi-search text-muted"></i></span>
                    <input type="text" class="form-control bg-light border-start-0" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏±‡πà‡∏ß‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö..." id="globalSearch">
                </div>

                <div class="notification-btn" onclick="checkNotifications()">
                    <i class="bi bi-bell"></i>
                    <span id="notifBadge" class="notification-badge hidden">0</span>
                </div>

                <div class="dropdown">
                    <button class="btn btn-light dropdown-toggle d-flex align-items-center gap-2" data-bs-toggle="dropdown">
                        <div class="bg-primary text-white rounded-circle d-flex justify-content-center align-items-center" style="width: 32px; height: 32px;">A</div>
                        <span class="d-none d-md-block small" id="adminEmailDisplay">Admin</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end shadow">
                        <li><a class="dropdown-item text-danger" href="#" onclick="logout()"><i class="bi bi-box-arrow-right me-2"></i>‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <div class="container-fluid px-4 py-4">
            
            <div class="row g-3 mb-4">
                <div class="col-md-3 col-6">
                    <div class="card p-3 border-start border-4 border-success h-100">
                        <div class="d-flex justify-content-between">
                            <div><small class="text-muted text-uppercase">‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</small><h3 class="fw-bold my-1 text-success" id="statIn">0</h3></div>
                            <div class="bg-success bg-opacity-10 p-2 rounded"><i class="bi bi-check-circle-fill text-success fs-4"></i></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="card p-3 border-start border-4 border-warning h-100">
                        <div class="d-flex justify-content-between">
                            <div><small class="text-muted text-uppercase">‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏•‡∏≤</small><h3 class="fw-bold my-1 text-warning" id="statLeave">0</h3></div>
                            <div class="bg-warning bg-opacity-10 p-2 rounded"><i class="bi bi-envelope-exclamation-fill text-warning fs-4"></i></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="card p-3 border-start border-4 border-info h-100">
                        <div class="d-flex justify-content-between">
                            <div><small class="text-muted text-uppercase">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</small><h3 class="fw-bold my-1 text-info" id="statTotalUsers">0</h3></div>
                            <div class="bg-info bg-opacity-10 p-2 rounded"><i class="bi bi-people-fill text-info fs-4"></i></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="card p-3 border-start border-4 border-danger h-100">
                        <div class="d-flex justify-content-between">
                            <div><small class="text-muted text-uppercase">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</small><h3 class="fw-bold my-1 text-danger" id="statNewUsers">0</h3></div>
                            <div class="bg-danger bg-opacity-10 p-2 rounded"><i class="bi bi-person-plus-fill text-danger fs-4"></i></div>
                        </div>
                    </div>
                </div>
            </div>

            <ul class="nav nav-tabs mb-4" id="mainTab" role="tablist">
                <li class="nav-item"><a class="nav-link active" onclick="switchTab('attendance')"><i class="bi bi-clock me-2"></i>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å</a></li>
                <li class="nav-item"><a class="nav-link" onclick="switchTab('schedule')"><i class="bi bi-calendar-check me-2"></i>‡∏à‡∏±‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏£</a></li>
                <li class="nav-item"><a class="nav-link" onclick="switchTab('leave')"><i class="bi bi-send me-2"></i>‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏≤</a></li>
                <li class="nav-item"><a class="nav-link" onclick="switchTab('report')"><i class="bi bi-graph-up me-2"></i>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô & ‡∏Å‡∏£‡∏≤‡∏ü</a></li>
                <li class="nav-item"><a class="nav-link" onclick="switchTab('users')"><i class="bi bi-person-gear me-2"></i>‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</a></li>
            </ul>

            <div id="tabAttendance">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <div class="d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3">
                            <div class="d-flex gap-2 align-items-center">
                                <label class="fw-bold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
                                <input type="date" id="filterDate" class="form-control">
                                <button onclick="loadData()" class="btn btn-primary px-3"><i class="bi bi-search me-1"></i> ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                            </div>
                            <button onclick="exportCSV()" class="btn btn-outline-success"><i class="bi bi-file-earmark-spreadsheet me-1"></i> Export CSV</button>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-hover table-striped align-middle mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th class="ps-3">‡πÄ‡∏ß‡∏•‡∏≤</th>
                                        <th>‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th>
                                        <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
                                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                        <th class="hide-mobile">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á/‡∏û‡∏¥‡∏Å‡∏±‡∏î</th>
                                    </tr>
                                </thead>
                                <tbody id="tableBody">
                                    <tr><td colspan="5" class="text-center py-5 text-muted"><div class="spinner-border text-primary mb-2"></div><br>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tabSchedule" class="hidden">
                <div class="row g-4">
                    <div class="col-lg-4">
                        <div class="card shadow-sm h-100">
                            <div class="card-header bg-white fw-bold py-3"><i class="bi bi-plus-circle me-2 text-primary"></i>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</div>
                            <div class="card-body">
                                <form onsubmit="createSchedule(event)">
                                    <div class="mb-3">
                                        <label class="form-label small text-muted">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
                                        <select id="userSelect" class="form-select" required></select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label small text-muted">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                                        <input type="date" id="schedDate" class="form-control" required>
                                    </div>
                                    <div class="mb-4">
                                        <label class="form-label small text-muted">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏∞</label>
                                        <select id="schedType" class="form-select">
                                            <option value="‡πÄ‡∏ä‡πâ‡∏≤ (08:00 - 17:00)">‚òÄÔ∏è ‡πÄ‡∏ä‡πâ‡∏≤ (08:00 - 17:00)</option>
                                            <option value="‡∏ö‡πà‡∏≤‡∏¢ (13:00 - 22:00)">üå§Ô∏è ‡∏ö‡πà‡∏≤‡∏¢ (13:00 - 22:00)</option>
                                            <option value="‡∏î‡∏∂‡∏Å (22:00 - 07:00)">üåô ‡∏î‡∏∂‡∏Å (22:00 - 07:00)</option>
                                            <option value="‡∏´‡∏¢‡∏∏‡∏î (Day Off)">üõë ‡∏´‡∏¢‡∏∏‡∏î (Day Off)</option>
                                        </select>
                                    </div>
                                    <button type="submit" class="btn btn-primary w-100 py-2"><i class="bi bi-save me-1"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏£</button>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-8">
                        <div class="card shadow-sm h-100">
                            <div class="card-header bg-white d-flex justify-content-between align-items-center py-3">
                                <span class="fw-bold"><i class="bi bi-list-check me-2"></i>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ß‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</span>
                                <button onclick="loadSchedules()" class="btn btn-sm btn-light border"><i class="bi bi-arrow-clockwise"></i></button>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-hover align-middle mb-0">
                                    <thead class="table-light"><tr><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th><th>‡∏Å‡∏∞</th><th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr></thead>
                                    <tbody id="schedTableBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tabLeave" class="hidden">
                <div class="card shadow-sm border-warning border-top-0 border-end-0 border-bottom-0 border-start-4">
                    <div class="card-header bg-white py-3 fw-bold"><i class="bi bi-hourglass-split text-warning me-2"></i>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</div>
                    <div class="table-responsive">
                        <table class="table table-hover align-middle mb-0">
                            <thead class="table-light"><tr><th class="ps-3">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th><th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th><th>‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</th><th class="text-end pe-3">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr></thead>
                            <tbody id="leaveTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="tabReport" class="hidden">
                <div class="card shadow-sm mb-4">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="fw-bold mb-0"><i class="bi bi-calendar-week me-2"></i>‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏á‡∏≤‡∏ô</h5>
                        </div>
                        <div id='calendar'></div>
                    </div>
                </div>

                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="card shadow-sm h-100">
                            <div class="card-header bg-white fw-bold py-3"><i class="bi bi-bar-chart-line me-2"></i>‡∏™‡∏£‡∏∏‡∏õ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
                            <div class="card-body">
                                <div class="d-flex gap-2 mb-3">
                                    <input type="month" id="chartMonth" class="form-control" style="width: 200px;">
                                    <button onclick="renderCharts()" class="btn btn-dark">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
                                </div>
                                <canvas id="workHoursChart" style="max-height: 300px;"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="card shadow-sm h-100">
                            <div class="card-header bg-white fw-bold py-3"><i class="bi bi-pie-chart me-2"></i>‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏≤</div>
                            <div class="card-body d-flex justify-content-center">
                                <canvas id="leavePieChart" style="max-height: 250px;"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tabUsers" class="hidden">
                <div class="row g-4">
                    <div class="col-lg-5">
                        <div class="card shadow-sm border-danger border-start-4">
                            <div class="card-header bg-white text-danger fw-bold py-3"><i class="bi bi-person-exclamation me-2"></i>‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Pending)</div>
                            <div class="table-responsive">
                                <table class="table table-hover align-middle mb-0">
                                    <tbody id="pendingUsersTable"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-7">
                        <div class="card shadow-sm border-primary border-start-4">
                            <div class="card-header bg-white text-primary fw-bold py-3 d-flex justify-content-between">
                                <span><i class="bi bi-people me-2"></i>‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                                <button onclick="loadAllUsers()" class="btn btn-sm btn-outline-primary"><i class="bi bi-arrow-clockwise"></i></button>
                            </div>
                            <div class="table-responsive" style="max-height: 500px;">
                                <table class="table table-hover align-middle mb-0">
                                    <thead class="table-light"><tr><th class="ps-3">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th><th>‡πÅ‡∏ú‡∏ô‡∏Å</th><th class="text-end pe-3">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr></thead>
                                    <tbody id="allUsersTable"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="modal fade" id="editUserModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow">
                <div class="modal-header border-0 bg-light">
                    <h5 class="modal-title fw-bold">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center p-4">
                    <img id="editUserImg" src="" class="profile-thumb shadow-sm mb-3" style="width:80px; height:80px;">
                    <input type="hidden" id="editUserId">
                    <div class="form-floating mb-3 text-start">
                        <input type="text" id="editUserName" class="form-control" placeholder="Name">
                        <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                    </div>
                    <div class="form-floating text-start">
                        <select id="editUserDept" class="form-select">
                            <option value="General">General</option>
                            <option value="Pharmacy">Pharmacy</option>
                            <option value="IT">IT Support</option>
                            <option value="Admin">Admin</option>
                            <option value="Sales">Sales</option>
                        </select>
                        <label>‡πÅ‡∏ú‡∏ô‡∏Å / ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                    </div>
                </div>
                <div class="modal-footer border-0 bg-light">
                    <button type="button" class="btn btn-light text-muted" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button type="button" class="btn btn-primary px-4" onclick="saveEditUser()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, sendSignInLinkToEmail, isSignInWithEmailLink, signInWithEmailLink, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, query, where, getDocs, setDoc, updateDoc, deleteDoc, doc, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // --- üî¥ CONFIGURATION ZONE ---
         const firebaseConfig = {

    apiKey: "AIzaSyDEe7ndwzIXokG50MbNykyMG2Ed2bYWvEI",

    authDomain: "in-out-dashboard.firebaseapp.com",

    projectId: "in-out-dashboard",

    storageBucket: "in-out-dashboard.firebasestorage.app",

    messagingSenderId: "846266395224",

    appId: "1:846266395224:web:44d1dfe11692f33ca5f82d",

    measurementId: "G-WN14VJSG17"

  };
        const ADMIN_EMAIL = "medlifeplus@gmail.com"; 
        // -----------------------------

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        let calendarObj = null;
        let editModal = null;
        let userProfileMap = {};
        let barChart = null; // Chart Instance
        let pieChart = null; // Chart Instance

        // 6. Toast Notification Helper
        const Toast = Swal.mixin({
            toast: true, position: 'top-end', showConfirmButton: false, timer: 3000,
            timerProgressBar: true, didOpen: (toast) => {
                toast.addEventListener('mouseenter', Swal.stopTimer);
                toast.addEventListener('mouseleave', Swal.resumeTimer);
            }
        });

        // AUTH Logic
        onAuthStateChanged(auth, async (user) => {
            if (user && user.email === ADMIN_EMAIL) {
                document.getElementById('loginPage').classList.add('d-none');
                document.getElementById('dashboardPage').classList.remove('hidden');
                document.getElementById('adminEmailDisplay').innerText = user.email;
                
                await cacheUserProfiles();
                loadInitialData();
                editModal = new bootstrap.Modal(document.getElementById('editUserModal'));
                document.getElementById('chartMonth').value = new Date().toISOString().slice(0, 7);
            } else {
                if (isSignInWithEmailLink(auth, window.location.href)) {
                    let e = localStorage.getItem('emailForSignIn') || prompt('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:');
                    signInWithEmailLink(auth, e, window.location.href).then(() => {
                        localStorage.removeItem('emailForSignIn');
                        window.history.replaceState({}, document.title, window.location.pathname);
                    }).catch(err => Swal.fire('Error', err.message, 'error'));
                } else {
                    document.getElementById('loginPage').classList.remove('d-none');
                }
            }
        });

        // 2. LOAD DATA (Attendance) with Improved UI
        window.loadData = async () => {
            const d = document.getElementById('filterDate').value;
            const s=new Date(d); s.setHours(0,0,0,0); const e=new Date(d); e.setHours(23,59,59,999);
            const tbody = document.getElementById('tableBody');
            
            // Skeleton Loading
            tbody.innerHTML = `<tr><td colspan="5" class="text-center py-5"><div class="spinner-border text-primary"></div></td></tr>`;

            const snap = await getDocs(query(collection(db,"attendance"), where("timestamp",">=",s), where("timestamp","<=",e)));
            let h = ""; window.currentData = []; let countIn=0;
            
            snap.forEach(doc => {
                const v = doc.data();
                window.currentData.push(v);
                if(v.type === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô') countIn++;
                
                const img = getProfileImg(v.userId);
                const time = new Date(v.timestamp.seconds*1000).toLocaleTimeString('th-TH', {hour:'2-digit', minute:'2-digit'}); // Monospace Format
                
                // 1. Color Status
                let statusClass = v.type==='‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô' ? 'text-status-in bg-success bg-opacity-10' : 'text-status-out bg-danger bg-opacity-10';
                let dotClass = v.type==='‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô' ? 'bg-status-in' : 'bg-status-out';
                
                // Map Button
                let mapBtn = v.mapUrl ? `<a href="${v.mapUrl}" target="_blank" class="btn btn-sm btn-light border text-primary" data-bs-toggle="tooltip" title="‡∏î‡∏π‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà"><i class="bi bi-geo-alt-fill"></i></a>` : '<span class="text-muted small">-</span>';

                h += `<tr>
                    <td class="ps-3"><span class="mono-font fs-6">${time}</span></td>
                    <td class="col-user">
                        <div class="user-cell">
                            ${img}
                            <div class="user-info">
                                <h6>${v.name}</h6>
                                <small>${v.empId || 'No ID'}</small>
                            </div>
                        </div>
                    </td>
                    <td><span class="badge bg-light text-dark border">${v.dept}</span></td>
                    <td><span class="badge ${statusClass} badge-pill"><span class="status-dot ${dotClass}"></span>${v.type}</span></td>
                    <td class="hide-mobile">${mapBtn}</td>
                </tr>`;
            });

            tbody.innerHTML = h || `<tr><td colspan="5" class="text-center py-5 text-muted"><i class="bi bi-inbox fs-1 d-block mb-2"></i>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</td></tr>`;
            document.getElementById('statIn').innerText = countIn;
        };

        // 10. Charts (Chart.js)
        window.renderCharts = async () => {
            const m = document.getElementById('chartMonth').value;
            if(!m) return;
            
            const start = new Date(m + "-01"); start.setHours(0,0,0,0);
            const end = new Date(m + "-01"); end.setMonth(end.getMonth() + 1); end.setDate(0); end.setHours(23,59,59,999);

            // Fetch Data
            const attSnap = await getDocs(query(collection(db, "attendance"), where("timestamp", ">=", start), where("timestamp", "<=", end)));
            let userHours = {};
            
            attSnap.forEach(d => {
                const v = d.data();
                if(!userHours[v.name]) userHours[v.name] = { logs: [], total: 0 };
                userHours[v.name].logs.push({ t:v.type, time: v.timestamp.seconds });
            });

            // Calculate Hours
            let labels = []; let dataHours = [];
            Object.keys(userHours).forEach(name => {
                const logs = userHours[name].logs.sort((a,b)=>a.time-b.time);
                let ms=0, last=null;
                logs.forEach(l => {
                    if(l.t==='‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô') last=l.time;
                    else if(l.t==='‡∏≠‡∏≠‡∏Å‡∏á‡∏≤‡∏ô' && last) { ms += (l.time-last); last=null; }
                });
                const hrs = (ms / 3600).toFixed(1);
                if(hrs > 0) { labels.push(name); dataHours.push(hrs); }
            });

            // Render Bar Chart
            if(barChart) barChart.destroy();
            const ctx = document.getElementById('workHoursChart').getContext('2d');
            barChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (‡∏ä‡∏°.)',
                        data: dataHours,
                        backgroundColor: 'rgba(54, 162, 235, 0.6)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1,
                        borderRadius: 5
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });

            // Pie Chart (Leave Types) - Placeholder Logic
            // (‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å collection leave_requests ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô)
        };

        // 12. Notification Logic
        window.checkNotifications = async () => {
            const pendingUsers = await getDocs(query(collection(db, "users"), where("status", "==", "Pending")));
            const pendingLeaves = await getDocs(query(collection(db, "leave_requests"), where("status", "==", "Pending")));
            
            const count = pendingUsers.size + pendingLeaves.size;
            const badge = document.getElementById('notifBadge');
            
            badge.innerText = count;
            badge.classList.toggle('hidden', count === 0);
            
            document.getElementById('statNewUsers').innerText = pendingUsers.size;
            document.getElementById('statLeave').innerText = pendingLeaves.size;

            if(count > 0) {
               // Optional: Show toast on load
            }
        };

        // --- CALENDAR (With Colors) ---
        function initCalendar(){
            if(calendarObj){calendarObj.render();return}
            calendarObj = new FullCalendar.Calendar(document.getElementById('calendar'),{
                initialView:'dayGridMonth',
                locale:'th',
                height:'auto',
                headerToolbar: { left: 'prev,next today', center: 'title', right: 'dayGridMonth,listMonth' },
                buttonText: { today: '‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ', month: '‡πÄ‡∏î‡∏∑‡∏≠‡∏ô', list: '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£' },
                events: async(info, success, fail) => {
                    try {
                        let evs = [];
                        const sSnap = await getDocs(collection(db,"schedules"));
                        sSnap.forEach(d => {
                            const v=d.data();
                            // 1. Color Logic
                            let c = 'var(--color-shift-am)';
                            if(v.shiftDetail.includes('‡∏ö‡πà‡∏≤‡∏¢')) c = 'var(--color-shift-pm)';
                            if(v.shiftDetail.includes('‡∏î‡∏∂‡∏Å')) c = 'var(--color-shift-night)';
                            if(v.shiftDetail.includes('‡∏´‡∏¢‡∏∏‡∏î')||v.shiftDetail.includes('‡∏•‡∏≤')) c = 'var(--color-leave)';
                            
                            evs.push({ title: `${v.name} (${v.shiftDetail.split('(')[0]})`, start:v.date, color: c });
                        });
                        success(evs);
                    } catch(e){ fail(e); }
                }
            });
            calendarObj.render();
        }

        // --- SHARED UTILS ---
        async function cacheUserProfiles() {
            const snap = await getDocs(collection(db, "users"));
            document.getElementById('statTotalUsers').innerText = snap.size;
            snap.forEach(d => { const v=d.data(); userProfileMap[d.lineUserId] = v.pictureUrl || "https://via.placeholder.com/45"; });
            checkNotifications(); // Check Notifs after load
        }
        function getProfileImg(uid) { return `<img src="${userProfileMap[uid]||'https://via.placeholder.com/45'}" class="profile-thumb">`; }
        function loadInitialData() { document.getElementById('filterDate').valueAsDate = new Date(); loadData(); loadUsersList(); loadPendingUsers(); }
        
        window.switchTab = (tab) => {
            // Hide all tabs
            document.querySelectorAll('[id^="tab"]').forEach(el => el.classList.add('hidden'));
            // Show selected
            document.getElementById('tab'+tab.charAt(0).toUpperCase()+tab.slice(1)).classList.remove('hidden');
            // Update Nav state
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
            event.currentTarget.classList.add('active'); // Fixed: use currentTarget

            if(tab==='schedule') loadSchedules();
            if(tab==='leave') loadLeaveRequests();
            if(tab==='report') { setTimeout(initCalendar, 200); renderCharts(); }
            if(tab==='users') { loadPendingUsers(); loadAllUsers(); }
        };

        // --- OTHER FUNCTIONS (Optimized) ---
        window.sendLoginLink = async () => {
            const btn = document.getElementById('btnSend');
            const spin = document.getElementById('btnSpinner');
            const txt = document.getElementById('btnText');
            
            btn.disabled = true; spin.classList.remove('d-none'); txt.innerText = " ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...";
            
            try {
                const e = document.getElementById('email').value;
                await sendSignInLinkToEmail(auth, e, { url: window.location.href, handleCodeInApp: true });
                window.localStorage.setItem('emailForSignIn', e);
                Toast.fire({ icon: 'success', title: '‡∏™‡πà‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! ‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢' });
                txt.innerText = "‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
            } catch(e) {
                Swal.fire('Login Error', e.message, 'error');
                btn.disabled = false; spin.classList.add('d-none'); txt.innerText = "‡∏™‡πà‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö";
            }
        };

        window.loadSchedules=async()=>{const s=await getDocs(query(collection(db,"schedules"),orderBy("date","desc")));let h="";s.forEach(d=>{const v=d.data();const img=getProfileImg(v.userId);h+=`<tr><td>${v.date}</td><td><div class="user-cell">${img} ${v.name}</div></td><td><span class="badge bg-light text-dark border">${v.shiftDetail}</span></td><td><button onclick="delSched('${d.id}')" class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button></td></tr>`});document.getElementById('schedTableBody').innerHTML=h};
        window.createSchedule=async(e)=>{e.preventDefault();const u=document.getElementById('userSelect');const uid=u.value;const nm=u.options[u.selectedIndex].text;await setDoc(doc(db,"schedules",`${uid}_${document.getElementById('schedDate').value}`),{userId:uid,name:nm,date:document.getElementById('schedDate').value,shiftDetail:document.getElementById('schedType').value});Toast.fire({icon:'success',title:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'});loadSchedules()};
        window.delSched=async(id)=>{
            const result = await Swal.fire({ title: '‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£?', icon: 'warning', showCancelButton: true, confirmButtonText: '‡∏•‡∏ö‡πÄ‡∏•‡∏¢', cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å' });
            if(result.isConfirmed) { await deleteDoc(doc(db,"schedules",id)); loadSchedules(); Toast.fire('‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à','','success'); }
        };
        window.loadLeaveRequests=async()=>{const s=await getDocs(query(collection(db,"leave_requests"),where("status","==","Pending")));let h="";s.forEach(doc=>{const d=doc.data();const img=getProfileImg(d.userId);h+=`<tr><td class="ps-3"><div class="user-cell">${img} <div><h6>${d.name}</h6><small>${d.dept}</small></div></div></td><td><span class="badge bg-warning text-dark">${d.type}</span></td><td>${d.startDate} - ${d.endDate}</td><td>${d.reason}</td><td class="text-end pe-3"><button onclick="updLeave('${doc.id}','Approved','${d.userId}','${d.name}','${d.startDate}','${d.endDate}','${d.type}')" class="btn btn-sm btn-success me-1"><i class="bi bi-check-lg"></i></button><button onclick="updLeave('${doc.id}','Rejected')" class="btn btn-sm btn-danger"><i class="bi bi-x-lg"></i></button></td></tr>`});document.getElementById('leaveTableBody').innerHTML=h||`<tr><td colspan="5" class="text-center py-4 text-muted">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÉ‡∏´‡∏°‡πà</td></tr>`;};
        window.updLeave=async(id,st,uid,nm,s,e,tp)=>{await setDoc(doc(db,"leave_requests",id),{status:st},{merge:true});if(st==='Approved'){let c=new Date(s),end=new Date(e);while(c<=end){let ds=c.toISOString().split('T')[0];await setDoc(doc(db,"schedules",`${uid}_${ds}`),{userId:uid,name:nm,date:ds,shiftDetail:`üõë ${tp}`});c.setDate(c.getDate()+1)}}Toast.fire({icon:'success',title:'‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'});loadLeaveRequests();checkNotifications();};
        window.loadPendingUsers=async()=>{const s=await getDocs(query(collection(db,"users"),where("status","==","Pending")));let h="";s.forEach(d=>{const v=d.data();h+=`<tr><td class="ps-3"><div class="user-cell"><img src="${v.pictureUrl}" class="profile-thumb"> <div><h6>${v.name}</h6><small class="text-danger">New Register</small></div></div></td><td class="text-end pe-3"><button onclick="appUser('${d.id}')" class="btn btn-sm btn-success px-3">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</button></td></tr>`});document.getElementById('pendingUsersTable').innerHTML=h||`<tr><td colspan="2" class="text-center py-3 text-muted">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏´‡∏°‡πà</td></tr>`;checkNotifications();};
        window.loadAllUsers=async()=>{const s=await getDocs(query(collection(db,"users"),where("status","==","Approved")));let h="";s.forEach(d=>{const u=d.data();h+=`<tr><td class="ps-3"><div class="user-cell"><img src="${u.pictureUrl}" class="profile-thumb"> <h6>${u.name}</h6></div></td><td><span class="badge bg-light text-dark border">${u.dept}</span></td><td class="text-end pe-3"><button onclick="openEditUser('${d.id}','${u.name}','${u.dept}','${u.pictureUrl}')" class="btn btn-sm btn-light border me-1"><i class="bi bi-pencil"></i></button><button onclick="delUser('${d.id}')" class="btn btn-sm btn-light border text-danger"><i class="bi bi-trash"></i></button></td></tr>`});document.getElementById('allUsersTable').innerHTML=h};
        window.appUser=async(id)=>{await setDoc(doc(db,"users",id),{status:"Approved"},{merge:true});Toast.fire({icon:'success',title:'‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß'});loadPendingUsers();loadAllUsers();};
        window.delUser=async(id)=>{const res=await Swal.fire({title:'‡∏•‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô?',text:'‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ',icon:'warning',showCancelButton:true,confirmButtonColor:'#dc3545'});if(res.isConfirmed){await deleteDoc(doc(db,"users",id));loadAllUsers();Toast.fire('‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à','','success')}};
        window.openEditUser=(id,nm,dp,pic)=>{document.getElementById('editUserId').value=id;document.getElementById('editUserName').value=nm;document.getElementById('editUserDept').value=dp;document.getElementById('editUserImg').src=pic;editModal.show()};
        window.saveEditUser=async()=>{try{await updateDoc(doc(db,"users",document.getElementById('editUserId').value),{name:document.getElementById('editUserName').value,dept:document.getElementById('editUserDept').value});Toast.fire({icon:'success',title:'‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'});editModal.hide();loadAllUsers();cacheUserProfiles();}catch(e){Swal.fire('Error',e.message,'error')}};
        window.logout=()=>signOut(auth);
        window.loadUsersList=async()=>{const s=await getDocs(query(collection(db,"users"),where("status","==","Approved")));let h='<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô...</option>';s.forEach(d=>h+=`<option value="${d.data().lineUserId}">${d.data().name}</option>`);document.getElementById('userSelect').innerHTML=h};
        window.exportCSV=()=>{if(!window.currentData?.length)return Toast.fire({icon:'warning',title:'‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ Export'});let c="Time,Name,Dept,Type,MapLink\n"+window.currentData.map(r=>`${new Date(r.timestamp.seconds*1000).toLocaleTimeString('th-TH')},${r.name},${r.dept},${r.type},${r.mapUrl||''}`).join("\n");const a=document.createElement("a");a.href="data:text/csv;charset=utf-8,"+encodeURI(c);a.download=`attendance_${new Date().toISOString().split('T')[0]}.csv`;a.click()};

        // Make Global
        window.sendLoginLink=sendLoginLink; window.logout=logout; window.loadData=loadData; window.exportCSV=exportCSV; window.loadSchedules=loadSchedules; window.createSchedule=createSchedule; window.delSched=delSched; window.loadLeaveRequests=loadLeaveRequests; window.updLeave=updLeave; window.loadPendingUsers=loadPendingUsers; window.loadAllUsers=loadAllUsers; window.appUser=appUser; window.delUser=delUser; window.openEditUser=openEditUser; window.saveEditUser=saveEditUser; window.switchTab=switchTab; window.renderCharts=renderCharts; window.loadAllUsers=loadAllUsers; window.checkNotifications=checkNotifications;
    </script>
</body>
</html>
